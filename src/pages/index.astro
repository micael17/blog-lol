---
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import Header from '../components/Header.astro';
import { SITE_NAME, SITE_DESCRIPTION, SITE_TITLE } from '../consts';
import { getCollection } from 'astro:content';

const guides = (await getCollection('guide')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 6);

const news = (await getCollection('news')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
).slice(0, 4);
---

<!doctype html>
<html lang="ko">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
	</head>
	<body>
		<Header />
		<main>
			<section class="hero">
				<div class="hero-content">
					<span class="hero-badge">League of Legends</span>
					<h1>{SITE_NAME}</h1>
					<p>{SITE_DESCRIPTION}</p>
				</div>
			</section>

			<section class="content-section">
				<div class="section-header">
					<h2>챔피언 공략</h2>
					<a href="/guide" class="view-all">전체보기 →</a>
				</div>
				{guides.length > 0 ? (
					<div class="guide-grid">
						{guides.map((post) => (
							<a href={`/guide/${post.id}/`} class="guide-card">
								<div class="card-meta">
									<span class="champion-tag">{post.data.champion}</span>
									<span class="role-tag">{post.data.role}</span>
								</div>
								<h3>{post.data.title}</h3>
								<p class="card-desc">{post.data.description}</p>
								<time datetime={post.data.pubDate.toISOString()}>
									{post.data.pubDate.toLocaleDateString('ko-KR')}
								</time>
							</a>
						))}
					</div>
				) : (
					<div class="empty-state">
						<p>공략 준비 중...</p>
					</div>
				)}
			</section>

			<section class="content-section news-section">
				<div class="section-header">
					<h2>뉴스</h2>
					<a href="/news" class="view-all">전체보기 →</a>
				</div>
				{news.length > 0 ? (
					<ul class="news-list">
						{news.map((post) => (
							<li>
								<a href={`/news/${post.id}/`}>
									<span class="news-category">{post.data.category}</span>
									<span class="news-title">{post.data.title}</span>
									<time datetime={post.data.pubDate.toISOString()}>
										{post.data.pubDate.toLocaleDateString('ko-KR')}
									</time>
								</a>
							</li>
						))}
					</ul>
				) : (
					<div class="empty-state">
						<p>뉴스 준비 중...</p>
					</div>
				)}
			</section>
		</main>
		<Footer />
	</body>
</html>

<style>
	.hero {
		background: rgb(var(--gray-900));
		color: rgb(var(--white));
		margin: 0 -1.5rem;
		padding: 4rem 1.5rem;
		text-align: center;
		margin-bottom: 3rem;
	}

	.hero-content {
		max-width: 600px;
		margin: 0 auto;
	}

	.hero-badge {
		display: inline-block;
		font-size: 0.75rem;
		font-weight: 600;
		text-transform: uppercase;
		letter-spacing: 0.1em;
		color: rgb(var(--accent));
		margin-bottom: 1rem;
	}

	.hero h1 {
		font-size: 3.5rem;
		margin: 0 0 1rem 0;
		letter-spacing: -0.03em;
		font-weight: 800;
		color: rgb(var(--white));
	}

	.hero p {
		color: rgb(var(--gray-400));
		margin: 0;
		font-size: 1.125rem;
	}

	.content-section {
		margin-bottom: 4rem;
	}

	.section-header {
		display: flex;
		justify-content: space-between;
		align-items: center;
		margin-bottom: 1.5rem;
		padding-bottom: 1rem;
		border-bottom: 1px solid rgb(var(--gray-200));
	}

	.section-header h2 {
		margin: 0;
		font-size: 1.5rem;
		font-weight: 700;
	}

	.view-all {
		font-size: 0.875rem;
		color: rgb(var(--gray-500));
		text-decoration: none;
		font-weight: 500;
		transition: color 0.2s;
	}

	.view-all:hover {
		color: rgb(var(--accent-dark));
		opacity: 1;
	}

	/* Guide Cards */
	.guide-grid {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 1.25rem;
	}

	.guide-card {
		display: block;
		padding: 1.5rem;
		background: rgb(var(--white));
		border: 1px solid rgb(var(--gray-200));
		border-radius: 12px;
		text-decoration: none;
		transition: all 0.2s;
	}

	.guide-card:hover {
		border-color: rgb(var(--accent));
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
		opacity: 1;
		transform: translateY(-2px);
	}

	.card-meta {
		display: flex;
		gap: 0.5rem;
		margin-bottom: 0.75rem;
	}

	.champion-tag {
		font-size: 0.75rem;
		font-weight: 600;
		padding: 0.25rem 0.5rem;
		background: rgb(var(--gray-900));
		color: rgb(var(--white));
		border-radius: 4px;
	}

	.role-tag {
		font-size: 0.75rem;
		padding: 0.25rem 0.5rem;
		background: rgb(var(--gray-100));
		color: rgb(var(--gray-600));
		border-radius: 4px;
	}

	.guide-card h3 {
		font-size: 1.125rem;
		font-weight: 600;
		margin: 0 0 0.5rem 0;
		color: rgb(var(--black));
		line-height: 1.4;
	}

	.card-desc {
		font-size: 0.875rem;
		color: rgb(var(--gray-500));
		margin: 0 0 0.75rem 0;
		line-height: 1.5;
		display: -webkit-box;
		-webkit-line-clamp: 2;
		-webkit-box-orient: vertical;
		overflow: hidden;
	}

	.guide-card time {
		font-size: 0.75rem;
		color: rgb(var(--gray-400));
	}

	/* News List */
	.news-section {
		background: rgb(var(--gray-50));
		margin: 0 -1.5rem;
		padding: 2.5rem 1.5rem;
	}

	.news-list {
		list-style: none;
		padding: 0;
		margin: 0;
	}

	.news-list li {
		border-bottom: 1px solid rgb(var(--gray-200));
	}

	.news-list li:last-child {
		border-bottom: none;
	}

	.news-list a {
		display: flex;
		align-items: center;
		gap: 1rem;
		padding: 1rem 0;
		text-decoration: none;
		transition: all 0.15s;
	}

	.news-list a:hover {
		opacity: 1;
	}

	.news-list a:hover .news-title {
		color: rgb(var(--accent-dark));
	}

	.news-category {
		font-size: 0.6875rem;
		font-weight: 600;
		text-transform: uppercase;
		padding: 0.25rem 0.5rem;
		background: rgb(var(--accent));
		color: rgb(var(--white));
		border-radius: 3px;
		flex-shrink: 0;
	}

	.news-title {
		flex: 1;
		font-weight: 500;
		color: rgb(var(--black));
		transition: color 0.15s;
	}

	.news-list time {
		font-size: 0.8125rem;
		color: rgb(var(--gray-400));
		flex-shrink: 0;
	}

	.empty-state {
		text-align: center;
		padding: 3rem 0;
		color: rgb(var(--gray-400));
		background: rgb(var(--gray-50));
		border-radius: 12px;
	}

	@media (max-width: 768px) {
		.hero {
			padding: 3rem 1rem;
		}

		.hero h1 {
			font-size: 2.5rem;
		}

		.guide-grid {
			grid-template-columns: 1fr;
		}

		.news-list a {
			flex-wrap: wrap;
		}

		.news-title {
			order: -1;
			width: 100%;
			margin-bottom: 0.25rem;
		}
	}
</style>
